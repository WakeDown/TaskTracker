@using TaskTracker.Models
@model TaskClaim
@{
    if (Model.ParentTaskId.HasValue)
    {
        ViewBag.Title = "Новая подзадача";
        ViewBag.HeaderBgColor = Model.ParentTask.Project.BgColor;
    }
    else
    {
        ViewBag.Title = "Новая задача";
    }
    Layout = "~/Views/Shared/_Layout.cshtml";
    }
<p>
    <div class="red lighten-3 red-text">
        @TempData["error"]
    </div>
    @using (Html.BeginForm("New", "Task", FormMethod.Post, new { enctype = "multipart/form-data", role = "form" }))
    {
        
        <div class="row">
            @if (Model.ParentTaskId.HasValue)
                {
                @Html.HiddenFor(m => m.ParentTaskId)
                @Html.HiddenFor(m => m.ProjectId)
                    <div class="col-lg-12">
                        <label>Надзадача</label>
                        <div>
                            <span class="marker @Model.ParentTask.Project.BgColor">
                                @Model.ParentTask.Project.Name
                            </span>
                        </div>
                        <div class="bold">
                            @Model.ParentTask.Name
                        </div>
                    </div>
            }
            else
            {
                <div class="col-lg-3">
                    <label for="project">Проект</label>
                    @Html.DropDownListFor(m => m.ProjectId, Project.GetSelectionList(), "--выберите проект--", new { id = "project", @class = "validate browser-default form-control", required = "required" })
                </div>
            }
        </div>
    <div class="row">
        <div class="input-field col-lg-6">
            <label for="name">Название</label>
            @Html.TextBoxFor(m => m.Name, new {@id = "name", @class = "validate form-control", required = "required"})

        </div>
              </div>
        <div class="row">
            <div class="input-field col-lg-6">
                <label for="descr">Описание</label>
                @Html.TextAreaFor(m => m.Descr, new {@id = "descr", @class = "validate  form-control", rows="6"})

            </div>
        </div>
        @*<div class="row">
            <div class="col s3">
                <label for="category">Категория</label>
                @Html.DropDownListFor(m => m.TaskCategoryId, TaskCategory.GetSelectionList(), new {required = "required", id = "category", @class = "browser-default"})
            </div>
        </div>
        <div class="row">
            <div class="col s3">
                <label for="specialist">Специалист</label>
                @Html.DropDownListFor(m => m.SpecialistSid, Specialist.GetProgrammersSelectionList(), "--специалист не указан--", new { id = "specialist", @class = "browser-default" })
            </div>
        </div>*@
        <div class="row">
            <div class="col-lg-6">
                @*@Html.Partial("AddFile")*@
                <input type="file" name="file" multiple>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6">
                <button class="btn btn-success waves-effect waves-light" type="submit" name="WindowClose" value="WindowClose">
                    Сохранить и закрыть
                </button>
                <button class="btn btn-success waves-effect waves-light" type="submit" name="Continue" value="Continue">
                    Сохранить и продолжить
                </button>
            </div>
        </div>
    }
</p>
